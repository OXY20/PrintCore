# 需求澄清清单（待确认）

> 目的：在进入实现前锁定协议、流程与边界，避免返工。

## 1. 通信与协议
1. 传输层最终选择：TCP 自定义协议还是 HTTP/JSON？（与开发文档对齐）
2. 是否需要 TLS？如果需要，证书如何分发与更新？
3. 是否需要心跳/保活机制？超时策略是多少？
4. 是否需要消息签名或重放防护？若需要，采用何种方式（nonce/时间戳/签名）？
5. 是否预留 TCP 自定义协议作为性能/可靠性瓶颈时的后备方案？（当前默认否，暂不开发，仅作为后续评估）


## 2. 认证与授权
6. 六位码/固定密钥的使用场景与有效期？是否支持解绑/更换？
7. 是否需要用户/组织/角色模型？还是仅设备级配对？
8. 允许多客户端同时连接同一服务端吗？是否需要连接白名单/黑名单？

## 3. 任务模型与状态机
9. 任务生命周期状态集合与状态迁移规则？（建议明确：queued/printing/succeeded/failed/canceled/retry/timeout）
10. 失败与重试策略：最大重试次数、间隔、失败原因分类？
11. 是否允许任务取消？取消在不同状态下的语义是什么？

## 4. 数据与文件传输
12. 支持的文件格式清单与限制（PDF/图片/文本等）？
13. 最大文件大小与分片/断点续传需求？
14. 服务端是否持久化任务文件？保存多久？存放路径与清理策略？

## 5. 打印能力与配置
15. 打印机能力发现是否必须？（纸张、单双面、彩色、份数、装订）
16. 客户端如何获取与选择打印机配置？是否需要默认配置模板？

## 6. 并发与队列
17. 队列策略：FIFO/优先级？是否允许任务插队？
18. 并发上限：单打印机并发=1？服务端总并发上限？
19. 多客户端提交冲突时的处理规则？

## 7. 运行与部署
20. 首个支持平台是否仅 Windows？跨平台目标与优先级？
21. 服务端如何安装为后台服务？是否需要系统托盘/开机自启？

## 8. 日志与可观测性
22. 需要记录哪些日志字段？（任务ID、来源、文件摘要、打印配置、耗时等）
23. 日志保留策略与敏感信息脱敏要求？

## 9. CLI/GUI 边界
24. GUI 是“管理控制台”还是“内置服务端”？
25. GUI 与 CLI 是否共享同一配置文件与数据存储？

## 10. 兼容性与虚拟打印机
26. 虚拟打印机驱动/方案已选定吗？（与 `docs/windows-virtual-printer-options.md` 对齐）
27. 打印失败的常见系统错误需要怎样的错误码映射？

---

填写方式示例：
- Q1：TCP 自定义协议（原因：需要长期连接与任务回执）
- Q2：需要 TLS，使用自签证书，首次配对时导入
