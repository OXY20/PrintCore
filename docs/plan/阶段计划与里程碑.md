# 项目阶段计划与里程碑（草案）

> 目标：以“文档优先 + 小步可验证”推进，实现路径清晰、可回退。

## 总体里程碑
- M0：需求澄清完成（协议、认证、状态机、文件传输、队列策略确认）
- M1：协议与数据模型定稿（与 `docs/protocol-spec.md` 同步）
- M2：CLI 版最小可用（本地单机 + 单客户端打印）
- M3：并发与状态机完善（多客户端、重试/取消、日志）
- M4：GUI 原型（Tauri，读状态 + 基本配置）
- M5：端到端稳定性与文档完善（安装/使用/故障排查）

## 阶段 0：需求与协议对齐（1–2 周）
交付物：
- `docs/plan/需求澄清清单.md` 完成并签字确认
- `docs/protocol-spec.md` 与开发文档一致（TCP/HTTP 二选一）
- 状态机定义（状态集合 + 迁移规则 + 错误码映射）
- 传输策略（文件大小上限、分片/断点续传、存储与清理）

验收标准：
- “连接/认证/提交任务/回执/失败”端到端流程可被文档化且无冲突

## 阶段 1：CLI 最小实现（2–4 周）
范围：
- 服务端：监听、认证、接收任务、调用本地打印、状态回传
- 客户端：虚拟打印机接入（或模拟），发送任务，接收回执

交付物：
- CLI 命令与参数规范（与文档一致）
- 任务状态日志（至少：queued/printing/succeeded/failed）
- 简易示例与操作手册（安装、启动、提交、查看状态）

验收标准：
- 单客户端在 Windows 上完成一次 PDF 打印任务
- 失败时能返回明确错误码与日志

## 阶段 2：并发与可靠性（2–3 周）
范围：
- 多客户端并发连接与队列策略
- 重试/取消/超时机制
- 日志结构化与可检索

交付物：
- 队列策略说明（FIFO/优先级）与实现
- 任务取消与重试策略文档
- 运行时配置项清单

验收标准：
- 多客户端同时提交任务，队列行为与文档一致
- 任务可取消、失败可重试

## 阶段 3：GUI 原型（2–3 周）
范围：
- Tauri GUI：展示服务端状态、任务列表、连接配置

交付物：
- GUI 原型与界面流程图
- 与 CLI 共享的配置/日志位置说明

验收标准：
- GUI 可展示任务列表与状态变化
- 关键配置可在 GUI 中修改并生效

## 阶段 4：完善与发布（2–4 周）
范围：
- 稳定性与错误处理
- 安装/部署/升级文档

交付物：
- 使用手册与故障排查
- 版本发布说明（变更/兼容性）

验收标准：
- 端到端演示顺利完成
- 文档可指导新用户独立部署

---

## 风险与缓解
- 协议不一致：优先统一协议文档并冻结版本
- 文件传输大/慢：明确分片与清理策略
- 打印驱动差异：优先 Windows 兼容，后续分平台适配

## 下一个动作
- 逐条确认 `docs/plan/需求澄清清单.md`
- 根据确认结果更新 `docs/protocol-spec.md` 与开发文档
